<!DOCTYPE html>
<html>
  <head>
  <title>Task Overview Page</title>
  <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns"
    crossorigin="anonymous">
  	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
  	<link rel="stylesheet" href="/css/layout.css">

</head>



<script>
  // Note: This example requires that you consent to location sharing when
  // prompted by your browser. If you see the error "The Geolocation service
  // failed.", it means you probably did not give permission for the browser to
  // locate you.
  var map;
  var service;
  var infowindow;

  function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 13
    });//
    infoWindow = new google.maps.InfoWindow;

    // current location
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var pos = {
          lat: position.coords.latitude,
          lng: position.coords.longitude
        };///end if statement

        infoWindow.setPosition(pos);
        infoWindow.setContent('You are here!');
        infoWindow.open(map);
        map.setCenter(pos);


        var request = {
            location: pos,
            radius: '1000',
            type: ['park']
          };//end var request

          service = new google.maps.places.PlacesService(map);
          service.nearbySearch(request, callback);

      }, function() {
        handleLocationError(true, infoWindow, map.getCenter());
      });
    } else {
      // Browser doesn't support Geolocation
      handleLocationError(false, infoWindow, map.getCenter());
    }
  }//end function initMap


  function callback(results, status) {
    if (status == google.maps.places.PlacesServiceStatus.OK) {
      for (var i = 0; i < results.length; i++) {
        var place = results[0];///var place = results[0]; to mark only 1 place
        createMarkers(place);
      }
    }
  }//end function callback

  function createMarkers(place) {

      var image = {
        url: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
        size: new google.maps.Size(100,100),
        origin: new google.maps.Point(0, 0),
        anchor: new google.maps.Point(17, 34),
        scaledSize: new google.maps.Size(25, 25)
      }

      var marker = new google.maps.Marker({
        map: map,
        icon: image,
        title: place.name,
        position: place.geometry.location,
      });

      marker.addListener('click', function() {
      map.setZoom(16);
      map.setCenter(marker.getPosition());
      infowindow.open(marker.get('map'), marker);
      });

      var myGoal = '<p><a id ="Task1" href="task1" class="btn btn-info btn-lg" aria-hidden="true">Goal 1</a>'+ '<br></br>'+
               '<a id ="Task2" href="#" class="btn btn-info btn-lg" aria-hidden="true">Goal 2</a>'+ '<br></br>'+
                '<a id ="Task3" href="#" class="btn btn-info btn-lg" aria-hidden="true"></span>Goal 3</a>' +'</p>';


      var infowindow = new google.maps.InfoWindow({
        content: myGoal
      });
    }//end function
</script>

<body>
  <div class="header" id="task_overview">
    <h1>Goal Overview</h1>
  </div>
<br>

<button onclick="goBack()"> Go Back</button>
<h5 style="text-align: center">Map</h5>

<div id="map" style="width:100%;height:400px;"></div>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAaxRdT8G8uKojUzG1PX2OQyeXD-B3T64A&libraries=places&callback=initMap"></script>

<div class="icon-bar">
  <a href="tasks" ><i class="fa fa-home"></i></a>
  <a href="task_overview" class="active"><i class="fa fa-map-pin"></i></a>
  <a href="rewards"><i class="fa fa-trophy"></i></a>
</div>

</body>
</html>
